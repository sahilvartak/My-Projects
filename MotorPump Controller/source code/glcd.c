/*Program to display Image on Graphics LCD using pic16f*/
#include"glcd_dat.h"

#define DPORT PORTA

#define RS RC0_bit
#define RW RC1_bit
#define EN RC2_bit
#define CS1 RC6_bit
#define CS2 RC7_bit


/*********Global variables*******************/
unsigned char column;
const unsigned char zero[]={0};
// ------------------------------------------------------
// GLCD Picture name: SV-CORP.bmp
// GLCD Model: KS0108 128x64
// ------------------------------------------------------

const code char logo[1024] = {
255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1, 193, 193, 225, 225, 225, 225, 193, 193,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1,   1, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 128, 128, 128, 128, 128,   0,   0,   0,   0,   0,   0,   0,   0,   0, 128, 128, 135, 143, 143,  15,  15,  15,  15,  31,  51, 240, 224, 192,   0,   0,  24,  60, 254, 254, 254, 126, 126,  60,  24,   0,   0, 128, 192, 224, 240, 252, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,   0,   0,   0,   0,   0,   0,   0,   0,   0,  15,  31,  31,  63,  63,  63, 127, 255, 207, 128, 128,   0,   0,   0,  15,  31,  31,  63,  63,  63, 127, 127, 206, 128, 128,   0,  24,  63, 127, 224, 192, 128, 128, 128, 255, 255, 224, 240, 240, 120, 124,  62,  31,  15,   7,   3,   1,   0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,   0,   0,   0,   0,   0,   0,   0,   0,   0, 112, 248, 248, 248, 248, 248, 248, 248, 241,  99,  99,  99,  99,  67, 194, 198, 134, 134, 206, 220, 248, 240, 225, 243, 247, 254, 252, 248, 124,  62,  63,  31,  31,  15,  15,   7,   3,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 240, 240, 112, 112, 112, 112, 120, 120, 120, 120, 120,  61,  61,  61,  61,  61,  60,  60,  62,  30,  30,  30,  15,  15,   7,   7,   7,   3,   3,   3,   3,   3,   1,   1,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,  63,  31,  31,  95, 223, 223, 223, 223, 223, 223, 223, 223, 255, 223, 223, 159, 159,  31,  31,  31,  31, 223, 220, 252, 220,  28,  28,  28, 156, 220, 220, 252, 252, 252, 252, 252, 252, 252, 124,  60,  28, 156, 220, 220, 220, 220, 220, 156, 156, 252, 252, 252, 252, 124,  60,  60,  28, 156, 156, 156, 156,  28,  60,  60, 124, 252, 252, 252, 220, 220, 156,  28,  28,  28,  28, 220, 220, 220, 220, 223,  31,  31,  31,  63, 255, 255, 223, 223, 159,  31,  31,  31,  31,  31, 223, 223, 223, 223,  31,  31,  63,  63, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 246, 246, 246, 246, 246, 246, 246, 246, 246, 244, 240, 240, 241, 255, 255, 255, 255, 255, 254, 252, 240, 240, 241, 241, 240, 252, 254,  63, 191,  63, 249, 249, 249, 249, 249,  63, 255, 191, 248, 248, 240, 243, 247, 247, 247, 247, 247, 243, 243, 255, 255, 255,  60, 248, 240,  48, 227, 231, 231, 231, 231, 227, 240, 240, 248,  60, 255, 255, 247, 247, 247, 240, 240, 240, 240, 244, 244, 244, 252, 248,  48, 242, 242, 246, 247, 255, 255, 247, 247, 240, 240, 240, 240, 240, 244, 244, 252, 252, 252, 252, 254, 254, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 240, 247, 240, 255, 240, 244, 244, 255, 240, 255, 240, 255, 248, 247, 248, 255, 240, 244, 244, 255, 240, 254, 254, 255, 254, 240, 246, 255, 240, 254, 240, 255, 240, 244, 244, 255, 255, 255, 240, 246, 240, 255, 255, 240, 244, 244, 255, 255, 244, 242, 242, 255, 254, 240, 246, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255
};


/************Switch off GLCD*****************/
void ctrl_off()
{
        RS=0;
        RW=0;
        EN=0;
        CS1=0;
        CS2=0;
}

/**********DELAY FUNCTION********************/
void delay(unsigned int j)
{
        unsigned int i;
        for(i=0;i<j;i++);
}

/**********Display ON************************/
void display_on()
{
        ctrl_off();
        DPORT=0x3f;
        CS1=0;CS2=0;
        RW=0;RS=0;
        EN=1;
        delay(100);
        EN=0;
}

/***************Display OFF*******************/
void display_off()
{
        ctrl_off();
        DPORT=0x3e;
        CS1=1;CS2=1;
        RS=0;RW=0;
        EN=1;
        delay(10);
        EN=0;
}

/*************Set Column********************/
void set_column(unsigned char col)
{
        if(col<64)
        {
                ctrl_off();
                column=col;
                DPORT=0x40|(col&63);          //0x40 represents Column 0
                CS1=0;CS2=1;
                RS=0;
                RW=0;
                EN=1;
                delay(10);
                EN=0;
        }
        else
        {
                column=col;
                DPORT=0x40|((col-64)&63);          //0x40 represents Column 0
                CS2=0;CS1=1;
                RS=0;
                RW=0;
                EN=1;
                delay(10);
                EN=0;

        }
}

/******************Set Page***********************/
void set_page(unsigned char page)
{
        ctrl_off();
        DPORT= 0xb8|page;           //0xb8 represents Page 0
        RS=0;
        RW=0;
        delay(10);
        EN=1;
        delay(10);
        EN=0;
}

/***********Scroll Strings**********************/
void set_start_line(unsigned char line)
{
        ctrl_off();
        DPORT=0xc0|line;           //0xc0 represents Line 0
        CS1=0; CS2=0;
        RS=0;
        RW=0;
        EN=1;
        delay(10);
        EN=0;
}

/****************Send LCD Data*******************/
void lcd_data(const unsigned char *value,unsigned int limit)
{
        unsigned int i;
        for(i=0;i<limit;i++)
        {
                if(column<64)
                {
                        DPORT=value[i];
                        CS1=0;CS2=1;
                        RS=1;
                        RW=0;
                        EN=1;
                        delay(10);
                        EN=0        ;
                        column++;
                }
                else
                {
                        set_column(column);
                        DPORT=value[i];
                        CS2=0;CS1=1;
                        RS=1;
                        RW=0;
                        EN=1;
                        delay(10);
                        EN=0        ;
                        column++;
                }
                if(column>127)
                   return;
        }
}

/****************Font size 8x8*********************************/
void lcd_puts1(unsigned char col,unsigned char page,unsigned char *str)
{
        unsigned char i;
        unsigned int a;
        set_column(col);
        set_page(page);
        for(i=0;str[i]!=0;i++)
        {
                a=(*(str+i));
                a*=8;
                lcd_data(&Character8x8[a],8);
        }
}

/******************Font Size 5x7**********************************/
void lcd_puts2(unsigned char col,unsigned char page,unsigned char *str)
{
        unsigned char i;
        unsigned int a;
        set_column(col);
        set_page(page);
        for(i=0;str[i]!=0;i++)
        {
                a=(*(str+i)-32);
                a*=5;
                lcd_data(&font5x7[a],5);
        }
}


 void lcd_puts2_const(unsigned char col,unsigned char page,const unsigned char *str)
 {
      unsigned char i;
        unsigned int a;
        set_column(col);
        set_page(page);
        for(i=0;str[i]!=0;i++)
        {
                a=(*(str+i)-32);
                a*=5;
                lcd_data(&font5x7[a],5);
        }
 }
/***********************display Image***************************/
void picture(const unsigned char * val)
{
        unsigned char j;
        set_column(0);
        set_page(0);
        for (j=0;j<8;j++)
        {
                set_page(j);
                set_column(0);
                lcd_data(&val[(j*128)],128);
        }
}

/********************Clear LCD************************************/
void clr_lcd()
{
    unsigned char i,j;
    for (i=0;i < 8;i++)
    {
        set_page(i);
        set_column(0);
        for (j= 0 ;j < 128; j++)
        lcd_data(zero,1);
    }
}